<!DOCTYPE html>
<html>
<head>
    <!-- <title>Edit a template</title> -->
    <title><%= title %></title>
    <link rel="stylesheet" href="/stylesheets/style.css"/>
    <link rel="stylesheet" href="/css/email.css"/>
    <link rel="stylesheet" href="/css/template-editor.css"/>
    <link rel="stylesheet" type="text/css" href="/css/letter-preview.css"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="/javascripts/email-template-editor.js" id="<%= id %>"></script>
</head>
<body>
    <header>
        <% include ../partials/header %>
    </header>
    <h1 class="title"><%= title %></h1>

    <h2 class="section-header">Template Name</h2>
    <div class="error-container">
        <div id="name-container">
            <input id="name-container-text-field" contentEditable="true" value="<%= templateName %>">
        </div>
    </div>

    <h5> Choose from inactive templates: </h5>
    <select id="email-templates" name="templates">
        <% var options = []; %>
        <% for (var template of templates) {  
            if(template.active == false){
            %>
          <option data-subject= "<%= template.subject %>" data-body= "<%= template.body_text %>"} ><%= template.title %></option>
        <% }} %>
    </select>

    <form class="input-form" method="POST" action="/email-template-editor"></form>
    
    <h2 class="section-header">Subject</h2>
    <div id="email-subject-container">
        <input id="email-subject-text-area" contentEditable="true" id="text" name="subject" value="<%= subject %>"> 
    </div>
    <h2 class="section-header">Content</h2>
    <div id="email-body-container">
        <input id="email-body-text-area" contentEditable="true" id="text" name="body" value="<%= body %>">
    </div>
    <h3>&lt!TAG_NAME&gt in the letter will be replaced by the corresponding recomendee's information</h3>
    <button class="email-button" id = "saveTemplate" onclick="saveEmailTemplate()">Save</button>
</form>
</html> 

<script>
    $("#email-templates").change(function () {
        document.getElementById("email-subject-text-area").value = $(this).find(':selected').data('subject');
        document.getElementById("email-body-text-area").value = $(this).find(':selected').data('body');
    });  
</script>